<p id="notice"><%= notice %></p>

<%= form_tag new_group_invite_path(:group_id => @group.id, :sender_id => current_user.id), method: :post do %>

<h1> <%= @group.name %></h1>

<%= form_tag add_group_member_path(:id => @group.id), method: :put do %>

  <p>
    <!--%= hidden_field_tag :group, @group.id %-->
    <%= text_field_tag :search, params[:search], placeholder: "Enter Email" %>
    <%= submit_tag "Invite User", :name => nil %>
  </p>
<% end %>


<%= link_to 'Edit', edit_group_path(@group) %> |
<%= link_to 'Back', groups_path %> |
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @group.users.each do |user| %>
      <% @membership = Membership.search(user.id, @group.id).first %>
      <% next if @membership.active == false %>
      <tr>
        <td><%= user.first_name + " " + user.last_name %></td>
        <td><%= link_to 'View Profile', user %></td>
        <td><%#= link_to 'Banish', memberships_url(:user => user.id, :group => @group.id), method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <td><%= link_to 'Banish', remove_group_member_path(@group, :user_id => user.id, :group_id => @group.id), data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table> <br> <br>

<p>Listing Chores</p>

<p>To do</p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Date</th>
      <th>Person Responsible</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @group.chores.sort {|a,b| a.date <=> b.date }.each do |chore| %>
      <% next if chore.complete == true %>
      <% if User.exists?(chore.user_id) %>
        <% @name = User.find(chore.user_id).first_name %>
      <% else %>
        <% @name = 'None' %>
      <% end %>
      <tr>
        <td><%= chore.name %></td>
        <td><%= chore.date %></td>
        <td><%= @name %></td>
        <td><%= link_to 'Show', chore %></td>
        <td><%= link_to 'Edit', edit_chore_path(chore) %></td>
        <td><%= link_to 'Complete', chore_complete_path(chore) %> </td>
      </tr>
    <% end %>
  </tbody>
</table> <br>

<%= link_to 'New Chore', new_chore_path(:group_id => @group.id) %> <br> <br>

<p>Completed</p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Date</th>
      <th>Person Responsible</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
<% @group.chores.sort {|a,b| a.date <=> b.date }.each do |chore| %>
  <% next if chore.complete == false %>
  <% if User.exists?(chore.user_id) %>
    <% @name = User.find(chore.user_id).first_name %>
  <% else %>
    <% @name = 'None' %>
  <% end %>
  <tr>
    <td><%= chore.name %></td>
    <td><%= chore.date %></td>
    <td><%= @name %></td>
    <td><%= link_to 'Show', chore %></td>
    <td><%= link_to 'Edit', edit_chore_path(chore) %></td>
    <td><%= link_to 'Destroy', chore, method: :delete, data: { confirm: 'Are you sure?' } %></td>
  </tr>
<% end %>
</tbody>
</table>
<br>
<% end %>
